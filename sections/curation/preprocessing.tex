\subsection{Alignment and preprocessing of reads}
All sequence data generated in house will be processed homogenously to avoid pipeline related artifacts.

% Text written by Martin on 27jan2015

Following generation of raw reads on the sequencing machine, the reads will be converted to BAM format using Illumina2BAM\footnote{https://github.com/wtsi-npg/illumina2bam}. Illumina2BAM will be used to de-multiplex the lanes that have been sequenced so that the tags are isolated from the body of the read, decoded, and can be used to separate out each lane into lanelets containing individual samples from the multiplex library and the PhiX control.  Reads corresponding to the PhiX control are mapped and used with Sanger’s spatial filter program\footnote{https://github.com/wtsi-npg/pb_calibration} to identify reads from other lanelets that contain spatially oriented INDEL artefacts and mark them as QC fail. Mapping  of the Human samples is carried out using the BWA-MEM algorithm of the BWA software package, which is suitable for Illumina reads longer than 70bp\cite{2013arXiv1303.3997L}, with the GRCh37 1000 Genomes phase II reference (also known as hs37d5). PCR and optically duplicated reads are marked using Picard\footnote{http://broadinstitute.github.io/picard} MarkDuplicates.

In order to ensure the quality of the large quantity of BAMs produced for the project, an automatic quality control system is employed to reduce the number of data files that require manual intervention. This system is derived from the one originally designed for the UK10K  project (http://www.uk10k.org) and uses a series of empirically derived thresholds to assess summary metrics calculated from the input BAMs. These thresholds include: percentage of reads mapped; percentage of duplicate reads marked; various statistics measuring INDEL distribution against read cycle and an insert size overlap percentage. Any lane that falls below the “fail” threshold for any of the metrics is excluded; any lane that falls below the “warn” threshold on a metric is manually examined; and any lane that does not fall below either of these thresholds for any of the metrics is given a status of “pass” and allowed to proceed into the later stages of the pipeline.

Passed lanelets are then merged into BAMs corresponding to sample’s libraries and duplicates are marked again with Picard after which they are then merged into BAMs for each sample.  Finally sample level bam improvement is carried out using GATK\cite{McKenna01092010}\cite{DePristo2011} and samtools\cite{Li15082009}. This consists of re-alignment of reads around known and discovered INDELs followed by base quality score recalibration both using the GATK, lastly samtools calmd is applied and indexes are created.  Known INDELs for realignment are taken from Mill Devine and 1000G Gold set and the 1000G phase low coverage set both part of the Broad’s GATK resource bundle version 2.2. Known variants for BQSR are taken from dbSNP 137 also part of the Broad’s resource bundle. 

